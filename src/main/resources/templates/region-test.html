<input type="text" id="searchRegion" placeholder="지역 검색">
<ul id="searchResults"></ul>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    let regions = [{"id":1,"name":"서울특별시","level":1,"children":[{"id":17,"name":"종로구","level":2,"children":[]},{"id":18,"name":"중구","level":2,"children":[]},{"id":19,"name":"용산구","level":2,"children":[]},{"id":20,"name":"성동구","level":2,"children":[]},{"id":21,"name":"광진구","level":2,"children":[]},{"id":22,"name":"동대문구","level":2,"children":[]},{"id":23,"name":"중랑구","level":2,"children":[]},{"id":24,"name":"성북구","level":2,"children":[]},{"id":25,"name":"강북구","level":2,"children":[]},{"id":26,"name":"도봉구","level":2,"children":[]},{"id":27,"name":"노원구","level":2,"children":[]},{"id":28,"name":"은평구","level":2,"children":[]},{"id":29,"name":"서대문구","level":2,"children":[]},{"id":30,"name":"마포구","level":2,"children":[]},{"id":31,"name":"양천구","level":2,"children":[]},{"id":32,"name":"강서구","level":2,"children":[]},{"id":33,"name":"구로구","level":2,"children":[]},{"id":34,"name":"금천구","level":2,"children":[]},{"id":35,"name":"영등포구","level":2,"children":[]},{"id":36,"name":"동작구","level":2,"children":[]},{"id":37,"name":"관악구","level":2,"children":[]},{"id":38,"name":"서초구","level":2,"children":[]},{"id":39,"name":"강남구","level":2,"children":[]},{"id":40,"name":"송파구","level":2,"children":[]},{"id":41,"name":"강동구","level":2,"children":[]}]},{"id":2,"name":"부산광역시","level":1,"children":[{"id":42,"name":"중구","level":2,"children":[]},{"id":43,"name":"서구","level":2,"children":[]},{"id":44,"name":"동구","level":2,"children":[]},{"id":45,"name":"영도구","level":2,"children":[]},{"id":46,"name":"부산진구","level":2,"children":[]},{"id":47,"name":"동래구","level":2,"children":[]},{"id":48,"name":"남구","level":2,"children":[]},{"id":49,"name":"북구","level":2,"children":[]},{"id":50,"name":"해운대구","level":2,"children":[]},{"id":51,"name":"사하구","level":2,"children":[]},{"id":52,"name":"금정구","level":2,"children":[]},{"id":53,"name":"강서구","level":2,"children":[]},{"id":54,"name":"연제구","level":2,"children":[]},{"id":55,"name":"수영구","level":2,"children":[]},{"id":56,"name":"사상구","level":2,"children":[]},{"id":57,"name":"기장군","level":2,"children":[]}]},{"id":3,"name":"대구광역시","level":1,"children":[{"id":58,"name":"중구","level":2,"children":[]},{"id":59,"name":"동구","level":2,"children":[]},{"id":60,"name":"서구","level":2,"children":[]},{"id":61,"name":"남구","level":2,"children":[]},{"id":62,"name":"북구","level":2,"children":[]},{"id":63,"name":"수성구","level":2,"children":[]},{"id":64,"name":"달서구","level":2,"children":[]},{"id":65,"name":"달성군","level":2,"children":[]},{"id":66,"name":"군위군","level":2,"children":[]}]},{"id":4,"name":"인천광역시","level":1,"children":[{"id":67,"name":"중구","level":2,"children":[]},{"id":68,"name":"동구","level":2,"children":[]},{"id":69,"name":"미추홀구","level":2,"children":[]},{"id":70,"name":"연수구","level":2,"children":[]},{"id":71,"name":"남동구","level":2,"children":[]},{"id":72,"name":"부평구","level":2,"children":[]},{"id":73,"name":"계양구","level":2,"children":[]},{"id":74,"name":"서구","level":2,"children":[]},{"id":75,"name":"강화군","level":2,"children":[]},{"id":76,"name":"옹진군","level":2,"children":[]}]},{"id":5,"name":"광주광역시","level":1,"children":[{"id":77,"name":"동구","level":2,"children":[]},{"id":78,"name":"서구","level":2,"children":[]},{"id":79,"name":"남구","level":2,"children":[]},{"id":80,"name":"북구","level":2,"children":[]},{"id":81,"name":"광산구","level":2,"children":[]}]},{"id":6,"name":"대전광역시","level":1,"children":[{"id":82,"name":"동구","level":2,"children":[]},{"id":83,"name":"중구","level":2,"children":[]},{"id":84,"name":"서구","level":2,"children":[]},{"id":85,"name":"유성구","level":2,"children":[]},{"id":86,"name":"대덕구","level":2,"children":[]}]},{"id":7,"name":"울산광역시","level":1,"children":[{"id":87,"name":"중구","level":2,"children":[]},{"id":88,"name":"남구","level":2,"children":[]},{"id":89,"name":"동구","level":2,"children":[]},{"id":90,"name":"북구","level":2,"children":[]},{"id":91,"name":"울주군","level":2,"children":[]}]},{"id":8,"name":"세종특별자치시","level":1,"children":[]},{"id":9,"name":"경기도","level":1,"children":[{"id":92,"name":"수원시","level":2,"children":[{"id":268,"name":"장안구","level":3,"children":[]},{"id":269,"name":"권선구","level":3,"children":[]},{"id":270,"name":"팔달구","level":3,"children":[]},{"id":271,"name":"영통구","level":3,"children":[]}]},{"id":96,"name":"성남시","level":2,"children":[{"id":272,"name":"수정구","level":3,"children":[]},{"id":273,"name":"중원구","level":3,"children":[]},{"id":274,"name":"분당구","level":3,"children":[]}]},{"id":99,"name":"의정부시","level":2,"children":[]},{"id":100,"name":"안양시","level":2,"children":[{"id":275,"name":"만안구","level":3,"children":[]},{"id":276,"name":"동안구","level":3,"children":[]}]},{"id":102,"name":"광명시","level":2,"children":[]},{"id":103,"name":"평택시","level":2,"children":[]},{"id":104,"name":"안산시","level":2,"children":[{"id":277,"name":"상록구","level":3,"children":[]},{"id":287,"name":"단원구","level":3,"children":[]}]},{"id":105,"name":"과천시","level":2,"children":[]},{"id":106,"name":"구리시","level":2,"children":[]},{"id":107,"name":"남양주시","level":2,"children":[]},{"id":108,"name":"오산시","level":2,"children":[]},{"id":109,"name":"시흥시","level":2,"children":[]},{"id":110,"name":"군포시","level":2,"children":[]},{"id":111,"name":"의왕시","level":2,"children":[]},{"id":112,"name":"하남시","level":2,"children":[]},{"id":113,"name":"용인시","level":2,"children":[{"id":278,"name":"처인구","level":3,"children":[]},{"id":279,"name":"기흥구","level":3,"children":[]},{"id":280,"name":"수지구","level":3,"children":[]}]},{"id":116,"name":"이천시","level":2,"children":[]},{"id":117,"name":"안성시","level":2,"children":[]},{"id":118,"name":"광주시","level":2,"children":[]},{"id":119,"name":"여주시","level":2,"children":[]},{"id":120,"name":"가평군","level":2,"children":[]},{"id":121,"name":"양평군","level":2,"children":[]},{"id":122,"name":"부천시","level":2,"children":[{"id":281,"name":"원미구","level":3,"children":[]},{"id":282,"name":"소사구","level":3,"children":[]},{"id":283,"name":"오정구","level":3,"children":[]}]},{"id":125,"name":"동두천시","level":2,"children":[]},{"id":126,"name":"고양시","level":2,"children":[{"id":284,"name":"덕양구","level":3,"children":[]},{"id":285,"name":"일산동구","level":3,"children":[]},{"id":286,"name":"일산서구","level":3,"children":[]}]},{"id":129,"name":"양주시","level":2,"children":[]},{"id":130,"name":"포천시","level":2,"children":[]},{"id":132,"name":"화성시","level":2,"children":[]},{"id":133,"name":"연천군","level":2,"children":[]},{"id":134,"name":"김포시","level":2,"children":[]},{"id":135,"name":"파주시","level":2,"children":[]}]},{"id":10,"name":"충청북도","level":1,"children":[{"id":136,"name":"청주시","level":2,"children":[{"id":288,"name":"상당구","level":3,"children":[]},{"id":289,"name":"서원구","level":3,"children":[]},{"id":290,"name":"흥덕구","level":3,"children":[]},{"id":291,"name":"청원구","level":3,"children":[]}]},{"id":140,"name":"충주시","level":2,"children":[]},{"id":141,"name":"제천시","level":2,"children":[]},{"id":142,"name":"보은군","level":2,"children":[]},{"id":143,"name":"옥천군","level":2,"children":[]},{"id":144,"name":"영동군","level":2,"children":[]},{"id":145,"name":"증평군","level":2,"children":[]},{"id":146,"name":"진천군","level":2,"children":[]},{"id":147,"name":"괴산군","level":2,"children":[]},{"id":148,"name":"음성군","level":2,"children":[]},{"id":149,"name":"단양군","level":2,"children":[]}]},{"id":11,"name":"충청남도","level":1,"children":[{"id":150,"name":"천안시","level":2,"children":[{"id":292,"name":"동남구","level":3,"children":[]},{"id":293,"name":"서북구","level":3,"children":[]}]},{"id":152,"name":"공주시","level":2,"children":[]},{"id":153,"name":"보령시","level":2,"children":[]},{"id":154,"name":"아산시","level":2,"children":[]},{"id":155,"name":"서산시","level":2,"children":[]},{"id":156,"name":"논산시","level":2,"children":[]},{"id":157,"name":"계룡시","level":2,"children":[]},{"id":158,"name":"당진시","level":2,"children":[]},{"id":159,"name":"금산군","level":2,"children":[]},{"id":160,"name":"부여군","level":2,"children":[]},{"id":161,"name":"서천군","level":2,"children":[]},{"id":162,"name":"청양군","level":2,"children":[]},{"id":163,"name":"홍성군","level":2,"children":[]},{"id":164,"name":"예산군","level":2,"children":[]},{"id":165,"name":"태안군","level":2,"children":[]}]},{"id":12,"name":"전라남도","level":1,"children":[{"id":166,"name":"목포시","level":2,"children":[]},{"id":167,"name":"여수시","level":2,"children":[]},{"id":168,"name":"순천시","level":2,"children":[]},{"id":169,"name":"나주시","level":2,"children":[]},{"id":170,"name":"광양시","level":2,"children":[]},{"id":171,"name":"담양군","level":2,"children":[]},{"id":172,"name":"곡성군","level":2,"children":[]},{"id":173,"name":"구례군","level":2,"children":[]},{"id":174,"name":"고흥군","level":2,"children":[]},{"id":175,"name":"보성군","level":2,"children":[]},{"id":176,"name":"화순군","level":2,"children":[]},{"id":177,"name":"장흥군","level":2,"children":[]},{"id":178,"name":"강진군","level":2,"children":[]},{"id":179,"name":"해남군","level":2,"children":[]},{"id":180,"name":"영암군","level":2,"children":[]},{"id":181,"name":"무안군","level":2,"children":[]},{"id":182,"name":"함평군","level":2,"children":[]},{"id":183,"name":"영광군","level":2,"children":[]},{"id":184,"name":"장성군","level":2,"children":[]},{"id":185,"name":"완도군","level":2,"children":[]},{"id":186,"name":"진도군","level":2,"children":[]},{"id":187,"name":"신안군","level":2,"children":[]},{"id":188,"name":"포항시","level":2,"children":[{"id":294,"name":"남구","level":3,"children":[]},{"id":295,"name":"북구","level":3,"children":[]}]},{"id":190,"name":"경주시","level":2,"children":[]},{"id":191,"name":"김천시","level":2,"children":[]},{"id":192,"name":"안동시","level":2,"children":[]},{"id":193,"name":"구미시","level":2,"children":[]},{"id":194,"name":"영주시","level":2,"children":[]},{"id":195,"name":"영천시","level":2,"children":[]},{"id":196,"name":"상주시","level":2,"children":[]},{"id":197,"name":"문경시","level":2,"children":[]},{"id":198,"name":"경산시","level":2,"children":[]},{"id":199,"name":"의성군","level":2,"children":[]},{"id":200,"name":"청송군","level":2,"children":[]},{"id":201,"name":"영양군","level":2,"children":[]},{"id":202,"name":"영덕군","level":2,"children":[]},{"id":203,"name":"청도군","level":2,"children":[]},{"id":204,"name":"고령군","level":2,"children":[]},{"id":205,"name":"성주군","level":2,"children":[]},{"id":206,"name":"칠곡군","level":2,"children":[]},{"id":207,"name":"예천군","level":2,"children":[]},{"id":208,"name":"봉화군","level":2,"children":[]},{"id":209,"name":"울진군","level":2,"children":[]},{"id":210,"name":"울릉군","level":2,"children":[]}]},{"id":13,"name":"경상남도","level":1,"children":[{"id":211,"name":"창원시","level":2,"children":[{"id":296,"name":"의창구","level":3,"children":[]},{"id":297,"name":"성산구","level":3,"children":[]},{"id":298,"name":"마산합포구","level":3,"children":[]},{"id":299,"name":"마산회원구","level":3,"children":[]},{"id":300,"name":"진해구","level":3,"children":[]}]},{"id":216,"name":"진주시","level":2,"children":[]},{"id":217,"name":"통영시","level":2,"children":[]},{"id":218,"name":"사천시","level":2,"children":[]},{"id":219,"name":"김해시","level":2,"children":[]},{"id":220,"name":"밀양시","level":2,"children":[]},{"id":221,"name":"거제시","level":2,"children":[]},{"id":222,"name":"양산시","level":2,"children":[]},{"id":223,"name":"의령군","level":2,"children":[]},{"id":224,"name":"함안군","level":2,"children":[]},{"id":225,"name":"창녕군","level":2,"children":[]},{"id":226,"name":"고성군","level":2,"children":[]},{"id":227,"name":"남해군","level":2,"children":[]},{"id":228,"name":"하동군","level":2,"children":[]},{"id":229,"name":"산청군","level":2,"children":[]},{"id":230,"name":"함양군","level":2,"children":[]},{"id":231,"name":"거창군","level":2,"children":[]},{"id":232,"name":"합천군","level":2,"children":[]}]},{"id":14,"name":"제주도","level":1,"children":[{"id":233,"name":"제주시","level":2,"children":[]},{"id":234,"name":"서귀포시","level":2,"children":[]}]},{"id":15,"name":"강원특별자치도","level":1,"children":[{"id":235,"name":"춘천시","level":2,"children":[]},{"id":236,"name":"원주시","level":2,"children":[]},{"id":237,"name":"강릉시","level":2,"children":[]},{"id":238,"name":"동해시","level":2,"children":[]},{"id":239,"name":"태백시","level":2,"children":[]},{"id":240,"name":"속초시","level":2,"children":[]},{"id":241,"name":"삼척시","level":2,"children":[]},{"id":242,"name":"홍천군","level":2,"children":[]},{"id":243,"name":"횡성군","level":2,"children":[]},{"id":244,"name":"영월군","level":2,"children":[]},{"id":245,"name":"평창군","level":2,"children":[]},{"id":246,"name":"정선군","level":2,"children":[]},{"id":247,"name":"양양군","level":2,"children":[]},{"id":248,"name":"화천군","level":2,"children":[]},{"id":249,"name":"고성군","level":2,"children":[]},{"id":250,"name":"양구군","level":2,"children":[]},{"id":251,"name":"철원군","level":2,"children":[]},{"id":252,"name":"인제군","level":2,"children":[]}]},{"id":16,"name":"전북특별자치도 ","level":1,"children":[{"id":253,"name":"전주시","level":2,"children":[{"id":301,"name":"완산구","level":3,"children":[]},{"id":302,"name":"덕진구","level":3,"children":[]}]},{"id":255,"name":"군산시","level":2,"children":[]},{"id":256,"name":"익산시","level":2,"children":[]},{"id":257,"name":"정읍시","level":2,"children":[]},{"id":258,"name":"남원시","level":2,"children":[]},{"id":259,"name":"김제시","level":2,"children":[]},{"id":260,"name":"완주군","level":2,"children":[]},{"id":261,"name":"진안군","level":2,"children":[]},{"id":262,"name":"무주군","level":2,"children":[]},{"id":263,"name":"장수군","level":2,"children":[]},{"id":264,"name":"임실군","level":2,"children":[]},{"id":265,"name":"순창군","level":2,"children":[]},{"id":266,"name":"고창군","level":2,"children":[]},{"id":267,"name":"부안군","level":2,"children":[]}]}]; // 전체 지역 데이터를 저장할 배열

    // 1️⃣ 페이지 로드 시 모든 지역 데이터를 서버에서 가져오기
    $(document).ready(function () {
        $.get("/api/regions", function (data) {
            regions = data; // 서버에서 가져온 데이터를 저장
        });
    });

    // 2️⃣ 검색 입력 이벤트 (자동완성 + 트리구조 반영)
    $("#searchRegion").on("input", function () {
        let query = $(this).val().toLowerCase(); // 입력값 소문자로 변환
        if (query.length > 0) {
            let filteredRegions = regions.filter(region =>
                region.name.toLowerCase().includes(query) || // 지역명이 검색어 포함
                (region.parentName && region.parentName.toLowerCase().includes(query)) // 부모 지역도 검색어 포함
            );

            // 3️⃣ 트리 구조로 검색 결과를 그룹화 (시·도 > 시·군·구)
            let groupedResults = {};
            filteredRegions.forEach(region => {
                let parentName = region.parentName || "기타"; // 시·도 그룹화
                if (!groupedResults[parentName]) {
                    groupedResults[parentName] = [];
                }
                groupedResults[parentName].push(region);
            });

            // 4️⃣ 검색 결과를 화면에 표시
            let resultsHTML = "";
            for (let parent in groupedResults) {
                resultsHTML += `<li><strong>${parent}</strong><ul>`;
                resultsHTML += groupedResults[parent].map(region =>
                    `<li class="search-item" data-name="${region.name}">${region.name}</li>`
                ).join('');
                resultsHTML += `</ul></li>`;
            }
            $("#searchResults").html(resultsHTML);
        } else {
            $("#searchResults").html(""); // 입력값이 없으면 검색 결과 숨기기
        }
    });

    // 5️⃣ 자동완성 기능 - 클릭 시 입력 필드에 채우기
    $(document).on("click", ".search-item", function () {
        let selectedRegion = $(this).data("name");
        $("#searchRegion").val(selectedRegion);
        $("#searchResults").html(""); // 선택 후 목록 숨기기
    });
</script>
