<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¡œê·¸ì¸</title>
    <link rel="stylesheet" href="/css/login.css">
</head>
<body>
<div class="login-container">
    <h2>ë‚˜ë“¤ì´</h2>
    <img src="/images/logo.png" alt="ë¡œê³ " class="logo">
    <p class="subtitle">ì—¬í–‰ì˜ ê³„íšë¶€í„° ê²°ì‚°ê¹Œì§€</p>
    <p class="subtitle2">ë‚˜ë“¤ì´ì™€ í•¨ê»˜</p>

    <button class="login-btn">ë¡œê·¸ì¸</button>

    <button class="kakao-btn" onclick="login('kakao')">
        <img src="/images/kakao_logo.png" alt="ì¹´ì¹´ì˜¤ ì•„ì´ì½˜">ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸
    </button>

    <button class="google-btn" onclick="login('google')">
        <img src="/images/google_logo.png" alt="êµ¬ê¸€ ì•„ì´ì½˜">êµ¬ê¸€ ë¡œê·¸ì¸
    </button>
</div>

<script>
    function login(provider) {
        window.location.href = `/oauth2/authorization/${provider}`;
    }

    async function checkLoginStatus() {
        try {
            const response = await fetch('/auth/user/me', {
                method: 'GET',
                credentials: 'include',
                headers: { 'Authorization': `Bearer ${getCookie('accessToken')}` }
            });

            if (response.ok) {
                window.location.href = "/mypage";
            }
        } catch (error) {
            console.error("ğŸš¨ ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸ ì‹¤íŒ¨:", error);
        }
    }

    function getCookie(name) {
        const value = `; ${document.cookie}`;
        const parts = value.split(`; ${name}=`);
        if (parts.length === 2) return parts.pop().split(";").shift();
    }

    window.onload = checkLoginStatus;
</script>
</body>
</html>
